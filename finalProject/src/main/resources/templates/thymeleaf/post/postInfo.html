<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PostInfo</title>
    <link rel="stylesheet" type="text/css" href="/static/css/footer2.css">
    <link rel="stylesheet" type="text/css" href="/static/css/header2.css">
    <link rel="stylesheet" type="text/css" href="/static/css/post/postInfo.css">
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.1.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.delete-comment-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const commentNum = button.getAttribute('data-comment-num');
                    const postNum = button.getAttribute('data-post-num');
                    location.href = `/comment/commentDelete/${commentNum}?postNum=${postNum}`;
                });
            });
        });
    </script>
</head>
<header class="header">
    <div class="logo">StocKids</div>
    <nav>
        <ul>
            <li><a href="/">홈</a></li>
            <li id="list">관리자</li>
            <li><a href="#">주식 골라보기</a></li>
            <li><a href="/post/postList">게시판</a></li>
        </ul>
    </nav>

    <button class="login-btn">로그인</button>
</header>
<body>
<div class="main-content">
    <!-- 제목 -->
    <div class="post-title">
        [[${postCommand.postSubject}]]
    </div>

    <!-- 세부 정보 -->
    <div class="post-info">
        <div class="left-info">
            [[${postCommand.category}]] | [[${postCommand.postAuthor}]] | [[${#dates.format(postCommand.postTime,
            'yyyy-MM-dd HH:mm')}]]
        </div>
        <div class="right-info">
            조회수: [[${postCommand.viewCount}]] | 추천: [[${postCommand.likeCount}]] | 댓글:
        </div>
    </div>
    <hr>

    <!-- 내용 -->
    <div class="post-content">
        <p>[[${postCommand.postContents}]]</p>
    </div>
    <hr>

    <!-- 추천 이미지 버튼 -->
    <div class="recommend-button">
        <form action="/post/postLike" method="post">
            <input type="hidden" name="postNum" th:value="${postCommand.postNum}"/>
            <button type="submit" class="recommend-btn">
                <img src="/static/images/post/like.png" alt="추천" class="recommend-img"/>
                <br>추천
                <br><span class="like-count">[[${postCommand.likeCount}]]</span>
            </button>
        </form>
    </div>
    <br>

    <div th:each="dto : ${list}">
        <div class="comment-item">
            <div class="comment-header">
                <span class="comment-author" th:text="${dto.commentAuthor}"></span>
                <span class="comment-time" th:text="${#dates.format(dto.commentTime, 'MM-dd HH:mm:ss')}"></span>
            </div>
            <div class="comment-content">
                <span th:text="${dto.commentContents}"></span>
                <button th:if="${auth != null and auth.userId == dto.commentAuthorId}"
                        class="delete-comment-btn"
                        th:attr="data-comment-num=${dto.commentNum}, data-post-num=${postCommand.postNum}">
                    삭제
                </button>
            </div>
            <hr class="comment-divider">
        </div>
    </div>
    <div class="comment-section">
        <form action="/comment/commentWrite" method="post">
            <input type="hidden" name="postNum" th:value="${postCommand.postNum}"/>
            <textarea id="commentContents" name="commentContents" required placeholder="댓글을 작성해주세요..."></textarea>
            <button type="submit" class="comment-submit-btn">작성</button>
        </form>
    </div>
    <!-- 하단 버튼 -->
    <div class="post-buttons">
        <button th:if="${auth != null and auth.userId == postAuthorId}"
                th:attr="onclick='location.href=\'../postUpdate?postNum=' + ${postCommand.postNum} + '\''">글 수정
        </button>
        <button th:if="${auth != null and auth.userId == postAuthorId}" class="delete-button"
                th:attr="onclick='location.href=\'/post/postDelete/' + ${postCommand.postNum} + '\''">글 삭제
        </button>
        <button onclick="location.href='../postList'">글목록</button>
    </div>

    <br>
</div>
<footer class="footer">
    <p>© 2024 StocKids. 모든 권리 보유.</p>
    <ul>
        <li>이용약관</li>
        <li>개인정보 처리방침</li>
        <li>고객센터</li>
    </ul>
</footer>
</body>
</html>
